<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lokesh Mano • 01-Apr-2020" />


<title>Intro to R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="assets/lab.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><b>NBIS • Workshop on ggplot</b></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="schedule.html">
    <span class="fa fa-clipboard-list"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="lab.html">
    <span class="fa fa-flask"></span>
     
    Lab
  </a>
</li>
<li>
  <a href="precourse.html">
    <span class="fa fa-pencil-alt"></span>
     
    Precourse
  </a>
</li>
<li>
  <a href="info.html">
    <span class="fa fa-info"></span>
     
    Info
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Intro to R</h1>
<h3 class="subtitle">Workshop on ggplot</h3>
<h4 class="author"><b>Lokesh Mano</b> • 01-Apr-2020</h4>

</div>


<!-- rmd lab header -->
<!-- custom fonts -->
<p><link href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro:300,400,600|Ubuntu+Mono&amp;subset=latin-ext" rel="stylesheet"></p>
<p><br></p>
<p>R is a programming language for statistical computing, and data wrangling. It is open-source, widely used in data science, has a wide range of functions and algorithms for graphing and data analyses.</p>
<p>We will use R in this course for generating plots from different biological data that are of higher quality and standard for publications. To do this, you will brush-up your memory on some important aspects of R that are important for this course below:</p>
<div id="inputoutput" class="section level1">
<h1><span class="header-section-number">1</span> Input/Output</h1>
<p>Input and output of data and images is an important aspect with data analysis.</p>
<div id="text" class="section level2">
<h2><span class="header-section-number">1.1</span> Text</h2>
<p>Data can come in a variety of formats which needs to be read into R and converted to an R data type.</p>
<p>Text files are the most commonly used input. Text files can be read in using the function <code>read.table</code>. We have a sample file to use: <strong>iris.txt</strong>.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">dfr &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;iris.txt&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">stringsAsFactors=</span>F)</a></code></pre></div>
</div>
<p>This reads in a tab-delimited text file with a header. The argument <code>sep='\t'</code> is set by default to specify that the delimiter is a tab. <code>stringsAsFactors=F</code> setting ensures that character columns are not automatically converted to factors.</p>
<p>It’s always a good idea to check the data after import.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(dfr)</a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">str</span>(dfr)</a></code></pre></div>
</div>
<p>Check <code>?read.table</code> for other wrapper functions to read in text files.</p>
<p>Let’s filter this data.frame and create a new data set.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dfr1 &lt;-<span class="st"> </span>dfr[dfr<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>,]</a></code></pre></div>
</div>
<p>And we can write this as a text file.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">write.table</span>(dfr1,<span class="st">&quot;iris-setosa.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">row.names=</span>F,<span class="dt">quote=</span>F)</a></code></pre></div>
</div>
<p><code>sep=&quot;\t&quot;</code> sets the delimiter to tab. <code>row.names=F</code> denotes that rownames should not be written. <code>quote=F</code> specifies that doubles must not be placed around strings.</p>
</div>
</div>
<div id="data-frames" class="section level1">
<h1><span class="header-section-number">2</span> Data-Frames</h1>
<p>You have probably learnt about <code>data.frame</code> in your previous course and this is the most important data structure for generating plots using <code>ggplot</code>. So, below you have some quick exercises on how to work with Data-Frames.</p>
<p>Vectors positions can be accessed using <code>[]</code>. R follows 1-based indexing, meaning that the indexing starts at 1.</p>
<p>Data-frame or matrix positions can be accessed using <code>[]</code> specifying row and column like <code>[row,column]</code>.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">dfr &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dfr</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">dfr[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">dfr[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">dfr[<span class="dv">2</span>,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>##   x y
## 1 1 a
## 2 2 b
## 3 3 c
##   x y
## 1 1 a
## [1] 1 2 3
## [1] b
## Levels: a b c</code></pre>
</div>
<p>The function <code>cbind()</code> is used to join two data-frames column-wise.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">dfr1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">dfr2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">p =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">q =</span> <span class="kw">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">dfr1</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">dfr2</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw">cbind</span>(dfr1,dfr2)</a></code></pre></div>
<pre><code>##   x y
## 1 1 a
## 2 2 b
## 3 3 c
##   p q
## 1 4 d
## 2 5 e
## 3 6 f
##   x y p q
## 1 1 a 4 d
## 2 2 b 5 e
## 3 3 c 6 f</code></pre>
</div>
<p>Similarly, <code>rbind()</code> is used to join two data-frames row-wise.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">dfr1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">dfr2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">dfr1</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">dfr2</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw">rbind</span>(dfr1,dfr2)</a></code></pre></div>
<pre><code>##   x y
## 1 1 a
## 2 2 b
## 3 3 c
##   x y
## 1 4 d
## 2 5 e
## 3 6 f
##   x y
## 1 1 a
## 2 2 b
## 3 3 c
## 4 4 d
## 5 5 e
## 6 6 f</code></pre>
</div>
<p>Two data-frames can be merged based on a shared column using the <code>merge()</code> function.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">dfr1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">p =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>))</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">dfr2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">q =</span> <span class="kw">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;n&quot;</span>,<span class="st">&quot;o&quot;</span>))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">dfr1</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">dfr2</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">merge</span>(dfr1,dfr2,<span class="dt">by=</span><span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="kw">merge</span>(dfr1,dfr2,<span class="dt">by=</span><span class="st">&quot;x&quot;</span>,<span class="dt">all.x=</span>T)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">merge</span>(dfr1,dfr2,<span class="dt">by=</span><span class="st">&quot;x&quot;</span>,<span class="dt">all.y=</span>T)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw">merge</span>(dfr1,dfr2,<span class="dt">by=</span><span class="st">&quot;x&quot;</span>,<span class="dt">all=</span>T)</a></code></pre></div>
<pre><code>##   x p
## 1 1 a
## 2 2 b
## 3 3 c
## 4 4 d
##   x q
## 1 3 l
## 2 4 m
## 3 5 n
## 4 6 o
##   x p q
## 1 3 c l
## 2 4 d m
##   x p    q
## 1 1 a &lt;NA&gt;
## 2 2 b &lt;NA&gt;
## 3 3 c    l
## 4 4 d    m
##   x    p q
## 1 3    c l
## 2 4    d m
## 3 5 &lt;NA&gt; n
## 4 6 &lt;NA&gt; o
##   x    p    q
## 1 1    a &lt;NA&gt;
## 2 2    b &lt;NA&gt;
## 3 3    c    l
## 4 4    d    m
## 5 5 &lt;NA&gt;    n
## 6 6 &lt;NA&gt;    o</code></pre>
</div>
</div>
<div id="data-formats" class="section level1">
<h1><span class="header-section-number">3</span> Data formats</h1>
<p>In terms of the R (and other similar programming languages), the data can be viewed or stored in two main formats! They are called <code>wide</code> and <code>long</code> formats. Below you will see what exactly they stand for and why is it important for plotting in ggplot.</p>
<div id="wide-format" class="section level2">
<h2><span class="header-section-number">3.1</span> Wide format</h2>
<p>A quick preview:</p>
<p><strong>Counts Table</strong></p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sample_1
</th>
<th style="text-align:right;">
Sample_2
</th>
<th style="text-align:right;">
Sample_3
</th>
<th style="text-align:right;">
Sample_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000000003
</td>
<td style="text-align:right;">
321
</td>
<td style="text-align:right;">
303
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
492
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000419
</td>
<td style="text-align:right;">
696
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
472
</td>
<td style="text-align:right;">
951
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000457
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
109
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000460
</td>
<td style="text-align:right;">
399
</td>
<td style="text-align:right;">
405
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
445
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000001036
</td>
<td style="text-align:right;">
844
</td>
<td style="text-align:right;">
808
</td>
<td style="text-align:right;">
495
</td>
<td style="text-align:right;">
1065
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000001084
</td>
<td style="text-align:right;">
535
</td>
<td style="text-align:right;">
458
</td>
<td style="text-align:right;">
290
</td>
<td style="text-align:right;">
722
</td>
</tr>
</tbody>
</table>
</div>
<p>And we usually have our metadata related to the samples in another table like below:</p>
<p><strong>Metadata Table</strong></p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sample_ID
</th>
<th style="text-align:left;">
Sample_Name
</th>
<th style="text-align:left;">
Time
</th>
<th style="text-align:left;">
Replicate
</th>
<th style="text-align:left;">
Cell
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:left;">
t0_B
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
A431
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_3
</td>
<td style="text-align:left;">
t0_C
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
A431
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_4
</td>
<td style="text-align:left;">
t2_A
</td>
<td style="text-align:left;">
t2
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>Wide format data is called “wide” because it typically has a lot of columns which stretch widely across the page or your computer screen.</li>
<li>Most of us are familiar with looking at wide format data
<ul>
<li>It is convenient and we are more used to looking at data this way in our Excel sheets.</li>
<li>It often lets you see more of the data, at one time, on your screen</li>
</ul></li>
</ul>
</div>
<div id="long-format" class="section level2">
<h2><span class="header-section-number">3.2</span> Long format</h2>
<p>Below is glimpse how the long format of the same data look like:</p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Gene
</th>
<th style="text-align:left;">
Samples
</th>
<th style="text-align:right;">
count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000000003
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
321
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000419
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
696
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000457
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000460
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
399
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000001036
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
844
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000001084
</td>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:right;">
535
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000003
</td>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:right;">
303
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000419
</td>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:right;">
660
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000457
</td>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000000460
</td>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:right;">
405
</td>
</tr>
</tbody>
</table>
</div>
<p>Or to be even more complete and precise:</p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sample_ID
</th>
<th style="text-align:left;">
Sample_Name
</th>
<th style="text-align:left;">
Time
</th>
<th style="text-align:left;">
Replicate
</th>
<th style="text-align:left;">
Cell
</th>
<th style="text-align:left;">
Gene
</th>
<th style="text-align:right;">
count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000003
</td>
<td style="text-align:right;">
321
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000419
</td>
<td style="text-align:right;">
696
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000457
</td>
<td style="text-align:right;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000460
</td>
<td style="text-align:right;">
399
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000001036
</td>
<td style="text-align:right;">
844
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:left;">
t0_A
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000001084
</td>
<td style="text-align:right;">
535
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:left;">
t0_B
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000003
</td>
<td style="text-align:right;">
303
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:left;">
t0_B
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000419
</td>
<td style="text-align:right;">
660
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:left;">
t0_B
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000457
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:left;">
t0_B
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
A431
</td>
<td style="text-align:left;">
ENSG00000000460
</td>
<td style="text-align:right;">
405
</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>Long format data is typically less familiar to most humans
<ul>
<li>It seems awfully hard to get a good look at all (or most) of it</li>
<li>It seems like it would require more storage on your hard disk</li>
<li>It seems like it would be harder to enter data in a long format</li>
</ul></li>
</ul>
</div>
<div id="which-is-better" class="section level2">
<h2><span class="header-section-number">3.3</span> Which is better?</h2>
<ul>
<li>Well, there are some contexts where putting things in wide format is computationally efficient because you can treat data in a matrix format and to efficient matrix calculations on it.</li>
<li>However, adding data to wide format data sets is very hard:
<ol style="list-style-type: decimal">
<li>It is very difficult to conceive of analytic schemes that apply generally across all wide-format data sets.</li>
<li>Many tools in R want data in long format <strong>like ggplot</strong></li>
<li>The long format for data corresponds to the relational model for storing data, which is the model used in most modern data bases like the SQL family of data base systems.</li>
</ol></li>
<li>A more technical treatment of wide versus long data requires some terminology:
<ul>
<li><span style="color:blue">Identifier variables</span> are often categorical things that cross-classify observations into categories.</li>
<li><span style="color:red">Measured variables</span> are the names given to properties or characteristics that you can go out and measure.</li>
<li><span style="color:orange">Values</span> are the values that you measure are record for any particular measured variable.</li>
</ul></li>
<li>In any particular data set, what you might want to call an <span style="color:blue">Identifier variables</span> versus a <span style="color:red">Measured variables</span> can not always be entirely clear.
<ul>
<li>Other people might choose to define things differently.</li>
</ul></li>
<li>However, to my mind, it is less important to be able to precisely recognize these three entities in every possible situation (where there might be some fuzziness about which is which)</li>
<li>And it is more important to understand how <span style="color:blue">Identifier variables</span>, <span style="color:red">Measured variables</span>, and <span style="color:orange">Values</span> interact and behave when we are transforming data between wide and long formats.</li>
</ul>
</div>
</div>
<div id="conversion-between-formats" class="section level1">
<h1><span class="header-section-number">4</span> Conversion between formats</h1>
<p>As for the biological data analysis, to be able to use tools such as <strong>ggplot</strong>, in simple terms we should learn to convert our data:</p>
<p>As per our previous examples: We should learn to convert</p>
<p><strong>From this format</strong></p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: blue !important;">
</th>
<th style="text-align:right;font-weight: bold;color: blue !important;">
Sample_1
</th>
<th style="text-align:right;font-weight: bold;color: blue !important;">
Sample_2
</th>
<th style="text-align:right;font-weight: bold;color: blue !important;">
Sample_3
</th>
<th style="text-align:right;font-weight: bold;color: blue !important;">
Sample_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000000003
</td>
<td style="text-align:right;color: orange !important;">
321
</td>
<td style="text-align:right;color: orange !important;">
303
</td>
<td style="text-align:right;color: orange !important;">
204
</td>
<td style="text-align:right;color: orange !important;">
492
</td>
</tr>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000000419
</td>
<td style="text-align:right;color: orange !important;">
696
</td>
<td style="text-align:right;color: orange !important;">
660
</td>
<td style="text-align:right;color: orange !important;">
472
</td>
<td style="text-align:right;color: orange !important;">
951
</td>
</tr>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000000457
</td>
<td style="text-align:right;color: orange !important;">
59
</td>
<td style="text-align:right;color: orange !important;">
54
</td>
<td style="text-align:right;color: orange !important;">
44
</td>
<td style="text-align:right;color: orange !important;">
109
</td>
</tr>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000000460
</td>
<td style="text-align:right;color: orange !important;">
399
</td>
<td style="text-align:right;color: orange !important;">
405
</td>
<td style="text-align:right;color: orange !important;">
236
</td>
<td style="text-align:right;color: orange !important;">
445
</td>
</tr>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000001036
</td>
<td style="text-align:right;color: orange !important;">
844
</td>
<td style="text-align:right;color: orange !important;">
808
</td>
<td style="text-align:right;color: orange !important;">
495
</td>
<td style="text-align:right;color: orange !important;">
1065
</td>
</tr>
<tr>
<td style="text-align:left;color: orange !important;color: red !important;">
ENSG00000001084
</td>
<td style="text-align:right;color: orange !important;">
535
</td>
<td style="text-align:right;color: orange !important;">
458
</td>
<td style="text-align:right;color: orange !important;">
290
</td>
<td style="text-align:right;color: orange !important;">
722
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>To this format</strong></p>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sample_ID
</th>
<th style="text-align:left;">
Sample_Name
</th>
<th style="text-align:left;">
Time
</th>
<th style="text-align:left;">
Replicate
</th>
<th style="text-align:left;">
Cell
</th>
<th style="text-align:left;">
Gene
</th>
<th style="text-align:right;">
count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000003
</td>
<td style="text-align:right;color: orange !important;">
321
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000419
</td>
<td style="text-align:right;color: orange !important;">
696
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000457
</td>
<td style="text-align:right;color: orange !important;">
59
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000460
</td>
<td style="text-align:right;color: orange !important;">
399
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000001036
</td>
<td style="text-align:right;color: orange !important;">
844
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_1
</td>
<td style="text-align:left;color: blue !important;">
t0_A
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
A
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000001084
</td>
<td style="text-align:right;color: orange !important;">
535
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_2
</td>
<td style="text-align:left;color: blue !important;">
t0_B
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
B
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000003
</td>
<td style="text-align:right;color: orange !important;">
303
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_2
</td>
<td style="text-align:left;color: blue !important;">
t0_B
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
B
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000419
</td>
<td style="text-align:right;color: orange !important;">
660
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_2
</td>
<td style="text-align:left;color: blue !important;">
t0_B
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
B
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000457
</td>
<td style="text-align:right;color: orange !important;">
54
</td>
</tr>
<tr>
<td style="text-align:left;color: blue !important;">
Sample_2
</td>
<td style="text-align:left;color: blue !important;">
t0_B
</td>
<td style="text-align:left;color: blue !important;">
t0
</td>
<td style="text-align:left;color: blue !important;">
B
</td>
<td style="text-align:left;color: blue !important;">
A431
</td>
<td style="text-align:left;color: red !important;">
ENSG00000000460
</td>
<td style="text-align:right;color: orange !important;">
405
</td>
</tr>
</tbody>
</table>
</div>
<p>Here we will only cover the conversion from <code>wide</code> to <code>long</code>, as this is more relevant to us. For the other way around, one can look into <code>spread()</code> from the <code>tidyr</code> package.</p>
<div id="using-reshape2" class="section level2">
<h2><span class="header-section-number">4.1</span> Using reshape2</h2>
<p>By using the <code>melt()</code> function from the <strong>reshape2</strong> package we can convert the wide-formatted data into long-formatted data! Here, to combine the metadata table to the gene counts table, we will also use the <code>merge()</code> function like we did before!</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">gc &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/counts_filtered.txt&quot;</span>, <span class="dt">header =</span> T, <span class="dt">row.names =</span> <span class="dv">1</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">md &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/metadata_raw.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">rownames</span>(md) &lt;-<span class="st"> </span>md<span class="op">$</span>Sample_ID</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#merging gene counts table with metadata</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">merged_data_wide &lt;-<span class="st"> </span><span class="kw">merge</span>(md, <span class="kw">t</span>(gc), <span class="dt">by =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#removing redundant columns</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">merged_data_wide<span class="op">$</span>Row.names &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">merged_data_long &lt;-<span class="st"> </span><span class="kw">melt</span>(merged_data_wide, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;Sample_ID&quot;</span>,<span class="st">&quot;Sample_Name&quot;</span>,<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Replicate&quot;</span>,<span class="st">&quot;Cell&quot;</span>), <span class="dt">variable.name =</span> <span class="st">&quot;Gene&quot;</span>, <span class="dt">value.name =</span> <span class="st">&quot;count&quot;</span>)  </a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw">head</span>(merged_data_long)</a></code></pre></div>
<pre><code>##   Sample_ID Sample_Name Time Replicate Cell            Gene count
## 1  Sample_1        t0_A   t0         A A431 ENSG00000000003   321
## 2 Sample_10       t24_A  t24         A A431 ENSG00000000003   950
## 3 Sample_11       t24_B  t24         B A431 ENSG00000000003   760
## 4 Sample_12       t24_C  t24         C A431 ENSG00000000003  1436
## 5  Sample_2        t0_B   t0         B A431 ENSG00000000003   303
## 6  Sample_3        t0_C   t0         C A431 ENSG00000000003   204</code></pre>
</div>
</div>
<div id="using-tidyr" class="section level2">
<h2><span class="header-section-number">4.2</span> Using tidyr</h2>
<p>If you are more familiar with using <code>tidyverse</code> or <code>tidyr</code> packages, you can combine tables by <code>join()</code> and then use <code>gather()</code> to make long formatted data in the same command. This is a powerful and more cleaner way of dealing with data in R.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">gc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Gene&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(Sample_ID, count, <span class="op">-</span>Gene) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">full_join</span>(md, <span class="dt">by =</span> <span class="st">&quot;Sample_ID&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(Sample_ID, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(Gene,count), <span class="kw">c</span>(Gene,count)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>##    Sample_ID Sample_Name Time Replicate Cell            Gene count
## 1   Sample_1        t0_A   t0         A A431 ENSG00000000003   321
## 2   Sample_1        t0_A   t0         A A431 ENSG00000000419   696
## 3   Sample_1        t0_A   t0         A A431 ENSG00000000457    59
## 4   Sample_1        t0_A   t0         A A431 ENSG00000000460   399
## 5   Sample_1        t0_A   t0         A A431 ENSG00000001036   844
## 6   Sample_1        t0_A   t0         A A431 ENSG00000001084   535
## 7   Sample_1        t0_A   t0         A A431 ENSG00000001167   493
## 8   Sample_1        t0_A   t0         A A431 ENSG00000001460   150
## 9   Sample_1        t0_A   t0         A A431 ENSG00000001461   491
## 10  Sample_1        t0_A   t0         A A431 ENSG00000001497  1136</code></pre>
</div>
</div>
</div>
<div id="acknowledgements" class="section level1">
<h1><span class="header-section-number">5</span> Acknowledgements</h1>
<p>Much of the data format explanations and exercises were obtained from the GitHub of <a href="https://github.com/eriqande">Eric C. Anderson</a></p>
</div>
<div id="getting-help" class="section level1">
<h1><span class="header-section-number">6</span> Getting help</h1>
<ul>
<li>Use <code>?function</code> to get function documentation</li>
<li>Use <code>??bla</code> to search for a function</li>
<li>Use <code>args(function)</code> to get the arguments to a function</li>
<li>Go to the package CRAN page/webpage for vignettes</li>
<li><a href="http://www.cookbook-r.com/">R Cookbook</a>: General purpose reference.</li>
<li><a href="https://www.statmethods.net/">Quick R</a>: General purpose reference.</li>
<li><a href="https://stackoverflow.com/">Stackoverflow</a>: Online community to find solutions to your problems.</li>
</ul>
</div>
<div id="session-info" class="section level1">
<h1><span class="header-section-number">7</span> Session info</h1>
<div class="block-title-parent">
<div class="block-title small">
Output
</div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 19.10
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] reshape2_1.4.3   kableExtra_1.1.0 forcats_0.4.0    stringr_1.4.0   
##  [5] purrr_0.3.3      readr_1.3.1      tidyr_1.0.2      tibble_2.1.3    
##  [9] ggplot2_3.2.1    tidyverse_1.3.0  dplyr_0.8.3      captioner_2.2.3 
## [13] bookdown_0.17    knitr_1.27      
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5  xfun_0.12         haven_2.2.0       lattice_0.20-38  
##  [5] colorspace_1.4-1  vctrs_0.2.2       generics_0.0.2    viridisLite_0.3.0
##  [9] htmltools_0.4.0   yaml_2.2.0        rlang_0.4.3       pillar_1.4.3     
## [13] withr_2.1.2       glue_1.3.1        DBI_1.1.0         dbplyr_1.4.2     
## [17] modelr_0.1.5      readxl_1.3.1      plyr_1.8.5        lifecycle_0.1.0  
## [21] munsell_0.5.0     gtable_0.3.0      cellranger_1.1.0  rvest_0.3.5      
## [25] evaluate_0.14     fansi_0.4.1       highr_0.8         broom_0.5.4      
## [29] Rcpp_1.0.3        scales_1.1.0      backports_1.1.5   webshot_0.5.2    
## [33] jsonlite_1.6      fs_1.3.1          hms_0.5.3         digest_0.6.23    
## [37] stringi_1.4.5     grid_3.6.1        cli_2.0.1         tools_3.6.1      
## [41] magrittr_1.5      lazyeval_0.2.2    crayon_1.3.4      pkgconfig_2.0.3  
## [45] ellipsis_0.3.0    xml2_1.2.2        reprex_0.3.0      lubridate_1.7.4  
## [49] assertthat_0.2.1  rmarkdown_2.1     httr_1.4.1        rstudioapi_0.10  
## [53] R6_2.4.1          nlme_3.1-141      compiler_3.6.1</code></pre>
</div>
<p><strong>End of document</strong></p>
</div>


<div class="footer">
<div class="container" style="padding-top:5px;padding-bottom:5px;">
<p>
<span style="float:left; vertical-align:middle">
<b>2020 </b><a href="https://nbis.se/">NBIS</a> • <a href="https://www.scilifelab.se/">SciLifeLab</a> • <a href="https://www.biology.lu.se/education/phd-studies/graduate-research-school-in-genomic-ecology">GENECO</a>
</span>
<span style="float:right; vertical-align:middle">
<span class="footericon" style="padding-right:4px; padding-left:4px">
<a href="https://nbis.se/"><i class="fas fa-globe-americas"></i></a>
</span>
<span class="footericon" style="padding-right:4px; padding-left:4px">
<a href="https://twitter.com/NBISwe"><i class="fab fa-twitter"></i></a>
</span>
<span class="footericon" style="padding-left:4px">
<a href="https://www.linkedin.com/company/nbisweden/"><i class="fab fa-linkedin"></i></a>
</span>
</span>
</p>
</div>
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
